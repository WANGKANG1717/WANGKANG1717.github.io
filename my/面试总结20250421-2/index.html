<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  

  <!-- Baidu Tongji -->
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="It&#39;s an IT blog..."/>
  <meta name="keyword" content="C++,Java,SQL,WEB,图形学,实验,随笔"/>
  <link rel="shortcut icon" href="/img/avatar/head.png"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    

    
      <!-- gitalk start -->
      <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
      <link rel="stylesheet" href="/css/gitalk.css"/>
      <!-- gitalk end -->
    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://wangkang1717.github.io/my/面试总结20250421-2/">
  <title>
    
      面试总结20250421-2 - dead or alive
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">WK&#39;website</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">HOME</a>
          </li>

          
          
          
          
          <li>
            <a href="/archive/">
              
              ARCHIVES
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/about/">
              
              ABOUT
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              TAGS
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/categories/">
              
              CATEGORIES
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>SEARCH</a>
          </li>
          

          <!-- LangSelect -->
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: url('/img/header_img/archive_bg3.jpg');
      --intro-header-background-image-url-page: url('//img/header_img/archive_bg3.jpg');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/archive_bg3.jpg');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//img/header_img/archive_bg3.jpg');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('/img/header_img/archive_bg3.jpg'); */
      
    }

    
      #signature {/*signature*/
        background-image: url('/img/signature/wk.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#面试" title="面试">面试</a>
              
            </div>
            <h1>面试总结20250421-2</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by WK on
              2025-04-21
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">20</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">5.6k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            
            <!-- 不蒜子统计 start -->
            <span class="meta" id="busuanzi_container_page_pv">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h2 id="jdk8-开始，hashmap-底层原理？">jdk8 开始，hashmap 底层原理？</h2>
<ol>
<li>数据+链表+红黑树：每个 HashMap 实例都有一个默认大小的数组（桶），初始容量为 16，默认加载因子(load factor)为 0.75。当向 HashMap 中添加键值对时，首先根据键的哈希值计算出该键值对应该存放的桶的位置。如果发生哈希冲突（即多个键值对映射到同一个桶），则这些冲突的元素会以链表的形式链接起来。一旦某个桶中的链表长度超过特定阈值（默认为 8），并且 HashMap 的容量至少为 64，则这个链表会被转换成一棵红黑树，以此来提高查找效率。</li>
<li>引入红黑树解决哈希冲突：
<ol>
<li>在 JDK 8 之前，处理哈希冲突的方式仅通过链表实现。当出现大量的哈希冲突时，查找时间复杂度可能退化至 O(n)。</li>
<li>引入红黑树后，在最坏的情况下（即存在大量哈希冲突）查找时间复杂度降低到了 O(log n)，大大提高了性能。</li>
</ol>
</li>
<li>扩容机制：当 HashMap 中的元素数量超过了负载因子与当前容量的乘积时，会发生扩容操作，即将数组的容量扩大一倍，并重新计算每个元素的新位置（rehashing）。此过程有助于保持较低的哈希冲突率和良好的性能。</li>
<li>哈希操作：
<ol>
<li>判断是否为 null 键：如果键为 null，则返回哈希值 0。HashMap 允许 null 作为键，并将其固定存储在数组的第一个位置（索引为 0 的桶中）。</li>
<li>获取原始哈希码：调用键对象的 hashCode() 方法，得到原始哈希码 h。</li>
<li>高位与低位异或运算：将原始哈希码 h 的高 16 位与低 16 位进行异或运算：(h &gt;&gt;&gt; 16) 表示将哈希码无符号右移 16 位，然后与原哈希码进行异或操作。</li>
<li>这种扰动操作的目的是让高位的信息参与到最终的哈希值计算中，从而提高哈希分布的均匀性。</li>
</ol>
</li>
</ol>
<h2 id="mysql-最佳左匹配原则是什么？">mysql 最佳左匹配原则是什么？</h2>
<ol>
<li><strong>从最左边的列开始使用</strong>：当使用复合索引时，查询条件必须从索引的最左边的列开始使用才能利用到该索引。这意味着如果有一个索引是(col1, col2, col3)，那么查询条件中至少要包含 col1 才能用到这个索引。仅仅使用 col2 或 col3 作为查询条件无法直接利用这个复合索引。</li>
<li><strong>连续性</strong>：一旦跳过了某个索引列，后面的列也无法利用此索引。例如，在上面提到的索引结构下，WHERE col1 = ? AND col2 = ?可以有效利用索引，但是 WHERE col1 = ? AND col3 = ?则不能完全利用该索引，因为跳过了 col2。</li>
<li><strong>部分使用</strong>：如果查询条件包含了复合索引的前几列，即使没有涵盖所有列，也可以部分地利用该索引。例如，对于索引(col1, col2, col3)，查询 WHERE col1 = ?可以直接使用该索引来过滤数据；而 WHERE col1 = ? AND col2 = ?能更精确地缩小搜索范围。</li>
<li><strong>范围查询的影响</strong>：一旦在查询条件中出现了范围查询（如 BETWEEN, &lt;, &gt;等），后续的列将不能再使用索引进行精确查找。比如，在索引(col1, col2, col3)中，WHERE col1 = ? AND col2 BETWEEN ? AND ?只能有效利用到 col1 和 col2 上的索引，col3 将无法再利用该索引进行优化。</li>
</ol>
<h2 id="select-年龄，姓名，id-，-from-表-where-年龄-xx，走全表扫描了吗？">select(年龄，姓名，id)， from 表 where 年龄=xx，走全表扫描了吗？</h2>
<ol>
<li>全表扫描：如果查询条件没有任何索引，则会进行全表扫描，扫描整个表，然后再应用查询条件进行过滤。</li>
<li>索引扫描：如果查询条件有索引，则会使用索引进行快速定位，然后根据索引返回的结果进行过滤。</li>
<li>索引失效：如果查询条件有索引，但是索引失效了，则会进行全表扫描。</li>
</ol>
<h2 id="慢查询分析，怎么优化-sql？">慢查询分析，怎么优化 sql？</h2>
<ol>
<li>使用 EXPLAIN 分析查询计划
<ul>
<li>type：访问类型（如 ALL 表示全表扫描，ref 表示索引查找）。</li>
<li>key：实际使用的索引。</li>
<li>rows：扫描的行数（越少越好）。</li>
<li>Extra：额外信息（如 Using filesort 或 Using temporary 表示可能有性能问题）。</li>
</ul>
</li>
<li>优化索引：添加合适的索引、避免冗余索引、覆盖索引</li>
<li>优化查询语句：避免全表扫描、减少返回的数据量、避免不必要的排序和分组</li>
<li>优化表结构：选择合适的数据类型、拆分大表、归档历史数据</li>
<li>优化 JOIN 操作：确保 JOIN 列上有索引、避免笛卡尔积、减少 JOIN 表的数量</li>
<li>使用缓存：应用层缓存、MySQL 查询缓存</li>
</ol>
<h2 id="SELECT-怎么优化？">SELECT *怎么优化？</h2>
<h3 id="为什么需要优化-SELECT-？">为什么需要优化 SELECT *？</h3>
<ol>
<li>返回不必要的数据：SELECT * 会返回表中的所有列，即使你只需要其中的一部分字段。这会增加网络传输的开销，并占用更多的内存。</li>
<li>无法使用覆盖索引：如果查询的所有字段都包含在索引中（即覆盖索引），MySQL 可以直接从索引中获取数据，而无需回表查询。使用 SELECT * 通常会导致 MySQL 需要访问数据表本身，从而降低性能。</li>
<li>影响 JOIN 性能：在多表连接时，SELECT * 会返回所有表的所有字段，可能导致大量的冗余数据传输和更高的计算开销。</li>
<li>维护困难：使用 SELECT * 会使代码可读性变差，难以清楚地知道具体需要哪些字段。如果表结构发生变化（如新增或删除字段），可能引发意外问题。</li>
</ol>
<h3 id="如何优化-SELECT-？">如何优化 SELECT *？</h3>
<ol>
<li>
<p>明确指定需要的字段</p>
</li>
<li>
<p>利用覆盖索引</p>
</li>
<li>
<p>避免 SELECT COUNT(*)：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> table_name;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span>);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>分页查询优化:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 优化前</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">10000</span>, <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 优化后</span></span><br><span class="line"><span class="keyword">SELECT</span> id, name, email</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">&gt;</span> last_seen_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> id</span><br><span class="line">LIMIT <span class="number">10</span>;</span><br><span class="line">```</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>减少大字段的影响:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">-- 优化前</span></span><br><span class="line"> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> articles;</span><br><span class="line"></span><br><span class="line"> <span class="comment">-- 优化后</span></span><br><span class="line"> <span class="keyword">SELECT</span> id, title, author <span class="keyword">FROM</span> articles;</span><br><span class="line">```</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>联合查询优化：在多表连接时，避免使用 SELECT *，只选择需要的字段。</p>
</li>
<li>
<p>使用视图或存储过程</p>
</li>
<li>
<p>动态生成查询语句</p>
</li>
</ol>
<h2 id="分页怎么分，什么语句？">分页怎么分，什么语句？</h2>
<ol>
<li>使用 LIMIT 和 OFFSET</li>
<li>使用主键或唯一索引优化：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, name, email</span><br><span class="line">     <span class="keyword">FROM</span> users</span><br><span class="line">     <span class="keyword">WHERE</span> id <span class="operator">&gt;</span> last_seen_id</span><br><span class="line">     <span class="keyword">ORDER</span> <span class="keyword">BY</span> id</span><br><span class="line">     LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
</li>
<li>使用覆盖索引</li>
</ol>
<h2 id="LIMIT-深分页怎么处理">LIMIT 深分页怎么处理?</h2>
<p>在处理大数据量的分页查询时，使用 LIMIT 和 OFFSET 的方式（即深分页）会导致性能问题。这是因为即使你只需要少量的数据，数据库仍然需要扫描并跳过前面的所有行。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">10</span> <span class="keyword">OFFSET</span> <span class="number">100000</span>;</span><br></pre></td></tr></table></figure>
<p>在这种情况下，数据库需要扫描前 100,000 行数据才能返回第 100,001 到 100,010 行的数据，这显然是低效的。</p>
<ol>
<li>
<p>使用主键或唯一索引进行分页:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, name, email</span><br><span class="line">     <span class="keyword">FROM</span> users</span><br><span class="line">     <span class="keyword">WHERE</span> id <span class="operator">&gt;</span> last_seen_id</span><br><span class="line">     <span class="keyword">ORDER</span> <span class="keyword">BY</span> id</span><br><span class="line">     LIMIT <span class="number">10</span>, <span class="number">100000</span>;</span><br></pre></td></tr></table></figure>
<p>这种方式可以利用索引进行快速定位，并只返回需要的数据。</p>
</li>
<li>
<p>使用覆盖索引: <code>CREATE INDEX idx_id_name_email ON users(id, name, email);</code></p>
</li>
<li>
<p>使用延迟关联（Deferred Join）/子查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先通过索引快速定位需要的主键</span></span><br><span class="line"> <span class="keyword">SELECT</span> id</span><br><span class="line"> <span class="keyword">FROM</span> users</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id</span><br><span class="line"> LIMIT <span class="number">10</span> <span class="keyword">OFFSET</span> <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">-- 再根据主键回表查询完整数据</span></span><br><span class="line"> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"> <span class="keyword">FROM</span> users</span><br><span class="line"> <span class="keyword">WHERE</span> id <span class="keyword">IN</span> (<span class="comment">/* 上一步的结果 */</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="mysql-隔离级别哪些？">mysql 隔离级别哪些？</h2>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td>READ-UNCOMMITTED</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>READ-COMMITTED</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>REPEATABLE-READ</td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody>
</table>
<h2 id="事务-acid-特性？">事务 acid 特性？</h2>
<ol>
<li>A: Atomicity（原子性）</li>
</ol>
<p>事务的原子性是指事务是一个不可分割的工作单位，事务中包括的诸操作要么全部完成，要么全部不完成，事务的操作不受其他操作的影响。</p>
<ol start="2">
<li>C: Consistency（一致性）</li>
</ol>
<p>事务的一致性是指事务必须是数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。</p>
<ol start="3">
<li>I: Isolation（隔离性）</li>
</ol>
<p>事务的隔离性是指一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</p>
<ol start="4">
<li>D: Durability（持久性）</li>
</ol>
<p>事务的持久性是指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。</p>
<h2 id="反向代理-正向代理？">反向代理 / 正向代理？</h2>
<ul>
<li>正向代理：从客户端的角度出发，帮助客户端访问外部资源，隐藏客户端的身份。</li>
<li>反向代理：从服务器的角度出发，保护后端服务器，隐藏后端服务器的身份，并提供负载均衡、缓存等功能。</li>
</ul>
<h2 id="mysql-存储引擎？">mysql 存储引擎？</h2>
<ol>
<li>InnoDB</li>
</ol>
<ul>
<li>支持事务（ACID 特性）。</li>
<li>支持行级锁（Row-Level Locking），适合高并发环境。</li>
<li>支持外键约束（Foreign Key）。</li>
<li>提供崩溃恢复能力（Crash Recovery）。</li>
<li>使用聚簇索引（Clustered Index），主键查询性能优异。</li>
<li>数据存储在表空间中，支持大表和高并发操作。</li>
<li>适用场景：</li>
<li>需要事务支持的应用（如银行系统、电商系统）。</li>
<li>高并发读写场景。</li>
<li>数据完整性和一致性要求较高的场景。</li>
</ul>
<ol>
<li>MyISAM</li>
</ol>
<ul>
<li>不支持事务。</li>
<li>支持表级锁（Table-Level Locking），并发性能较差。</li>
<li>查询速度快，尤其适合以读为主的场景。</li>
<li>支持全文索引（Full-Text Index），但在 MySQL 5.6 之后，InnoDB 也支持全文索引。</li>
<li>数据存储在 .MYD（数据文件）和 .MYI（索引文件）中。</li>
<li>不支持外键。</li>
<li>适用场景：</li>
<li>以读为主的应用（如日志系统、数据仓库）。</li>
<li>不需要事务支持的场景。</li>
</ul>
<h2 id="InnoDB-行锁实现？">InnoDB 行锁实现？</h2>
<p>略</p>
<h2 id="数据库主从复制原理？">数据库主从复制原理？</h2>
<ol>
<li>主服务器（Master）：处理所有的写操作（如 INSERT、UPDATE、DELETE），并记录这些操作到二进制日志（Binary Log）中。</li>
<li>从服务器（Slave）：负责读取主服务器的二进制日志，并将其应用到自己的数据库中，从而保持与主服务器的数据同步。</li>
</ol>
<h2 id="redis-的持久化方式？">redis 的持久化方式？</h2>
<ol>
<li>RDB 持久化：RDB 持久化是指在指定的时间间隔内将内存中的数据集快照写入磁盘，它恢复时是将快照文件直接读到内存里。RDB 持久化可以配置，默认配置是每隔 10 分钟执行一次，可以根据需要修改。RDB 持久化是 Redis 默认的持久化方式，但它不支持 AOF 持久化。</li>
<li>AOF 持久化：AOF 持久化是指将写操作命令记录到文件中，并在 Redis 启动时，从文件中读取并重新执行这些命令，AOF 持久化可以配置，默认配置是每秒钟执行一次，可以根据需要修改。AOF 持久化支持多种同步策略，如 always、everysec、noappendfsync。AOF 持久化比 RDB 持久化更加安全，因为 AOF 持久化可以记录更多的命令，即使 Redis 发生故障也只会丢失一秒钟的数据。</li>
</ol>
<h2 id="简单说，缓存穿透，击穿，雪崩是什么，怎么解决">简单说，缓存穿透，击穿，雪崩是什么，怎么解决?</h2>
<ol>
<li>缓存穿透：指查询一个一定不存在的数据，由于缓存是不命中时被动写到数据库，并且出于容错考虑，如果从数据库查询不到对应的数据，则不写入缓存，这将导致这个不存在的数据每次请求都要到数据库去查询，失去了缓存的意义。</li>
<li>缓存击穿：指缓存中有某个热点数据，当大量的请求访问这个热点数据时，缓存失效，大量请求直接访问数据库，数据库压力过大，甚至导致雪崩。</li>
<li>缓存雪崩：指缓存服务器重启或者大量缓存集中失效，所有请求都直接访问数据库，数据库瘫痪，甚至宕机。</li>
<li>解决方案：
<ol>
<li>缓存空值：当缓存和数据库中都没有数据时，直接返回空值，避免缓存穿透。</li>
<li>缓存永不过期：当缓存和数据库中都有数据时，设置一个较短的过期时间，避免缓存击穿。</li>
<li>缓存更新策略：当缓存和数据库中都有数据时，更新缓存，避免缓存雪崩。</li>
<li>缓存预热：将热点数据提前加载到缓存中，避免缓存穿透和缓存雪崩。</li>
</ol>
</li>
</ol>
<h2 id="分布式锁除了-redis-还有什么方法">分布式锁除了 redis 还有什么方法?</h2>
<ol>
<li>数据库锁：可以通过数据库的唯一约束或事务来实现分布式锁。例如，在一个表中插入一条记录，这条记录的存在就代表了锁的状态。这种方法简单易懂，但性能通常不如专门的分布式锁服务。</li>
<li>Zookeeper：Apache Zookeeper 是一个分布式的协调服务，可以用来实现分布式锁。通过创建临时顺序节点，可以确保同一时间只有一个客户端能够获取到锁。Zookeeper 提供了强大的一致性和可靠性保障，但是它的性能可能比不上基于内存的解决方案（如 Redis）。</li>
</ol>
<h2 id="假如有一组数据，有序的，增删多，用什么集合">假如有一组数据，有序的，增删多，用什么集合?</h2>
<ol>
<li>TreeSet
<ul>
<li>特点: 基于红黑树实现，元素天然有序（默认升序），支持快速插入、删除和查找。</li>
<li>时间复杂度: 插入、删除和查找的时间复杂度为 O(log n)。</li>
<li>适用场景: 如果需要维护一个动态有序集合，并且频繁进行增删操作，TreeSet 是一个很好的选择。</li>
</ul>
</li>
<li>LinkedList
<ul>
<li>特点: 基于双向链表实现，支持快速的头尾插入和删除（O(1)），但中间插入和删除需要先找到位置（O(n)）。</li>
<li>适用场景: 如果数据量较小或者主要对头部或尾部进行操作，LinkedList 是可选方案。</li>
</ul>
</li>
</ol>
<h2 id="jvm-内存结构">jvm 内存结构</h2>
<ol>
<li>堆: 存放对象实例，是垃圾收集器管理的主要区域，也是 Java 内存管理的核心区域。</li>
<li>方法区: 存放类信息、常量、静态变量、即时编译器编译后的代码等数据。</li>
<li>虚拟机栈: 存放局部变量表、操作栈、动态链接、返回地址等信息。</li>
<li>本地方法栈: 存放 native 方法信息。</li>
<li>程序计数器: 存放当前线程执行的字节码的地址。</li>
<li>直接内存: 直接内存并不是虚拟机运行时数据区的一部分，而是通过 Native 函数库直接分配堆外内存。</li>
</ol>
<h2 id="垃圾回收算法哪几种">垃圾回收算法哪几种</h2>
<ol>
<li>标记-清除算法：首先标记出所有需要回收的对象，标记完成后统一回收。</li>
<li>复制算法：将内存分为两块，每次只使用其中一块，当这一块内存用完时，就将还存活的对象复制到另一块内存上，然后再把使用过的内存空间一次清理掉。</li>
<li>标记-整理算法：标记-清除算法的基础上，再进行一次碎片整理。</li>
<li>分代收集算法：根据对象存活周期不同，将内存分为几块，不同块采用不同的算法进行垃圾回收。</li>
</ol>
<h2 id="threallocal-原理">threallocal 原理</h2>
<p>ThreadLocal 是 Java 提供的一种用于实现线程本地存储的机制，它允许每个线程拥有某个变量的独立副本，从而避免线程间的共享和竞争。简单来说，ThreadLocal 的核心作用是为每个线程提供一个独立的变量副本，确保线程之间的数据隔离。</p>
<ul>
<li>线程隔离：每个线程都有自己独立的变量副本，线程之间互不干扰。</li>
<li>无需同步：由于每个线程操作的是自己的副本，因此不需要使用锁来保证线程安全。</li>
<li>生命周期绑定到线程：ThreadLocal 中存储的数据与线程的生命周期绑定，当线程结束时，存储在 ThreadLocal 中的数据也会被回收（前提是正确清理）。</li>
</ul>
<p>工作原理:</p>
<ul>
<li>每个线程（Thread）内部都有一个名为 threadLocals 的 ThreadLocalMap 对象。</li>
<li>当调用 ThreadLocal 的 set() 方法时，会将当前线程作为键，要存储的值作为值，存入该线程的 threadLocals 映射中。</li>
<li>当调用 get() 方法时，会从当前线程的 threadLocals 中查找对应的值。</li>
<li>如果没有调用过 set() 方法，则会返回 initialValue() 方法提供的默认值（默认为 null）。</li>
</ul>
<h2 id="ThreadLocalMap-防止内存泄漏">ThreadLocalMap 防止内存泄漏</h2>
<p>ThreadLocalMap 是 ThreadLocal 的核心实现，它负责存储每个线程的变量副本。然而，由于其特殊的存储机制（键是弱引用，值是强引用），如果使用不当，可能会导致内存泄漏问题。</p>
<h3 id="为什么会有内存泄漏的风险？">为什么会有内存泄漏的风险？</h3>
<ul>
<li>键是弱引用：在 ThreadLocalMap 中，键（ThreadLocal 实例）是通过弱引用（WeakReference）存储的。这意味着当没有其他强引用指向 ThreadLocal 实例时，垃圾回收器会回收该实例。</li>
<li>值是强引用：值（存储的数据）是强引用，即使 ThreadLocal 实例被回收了，值仍然会被 ThreadLocalMap 强引用着，不会被垃圾回收。</li>
<li>线程长期存活：如果线程长时间运行（例如线程池中的线程），而 ThreadLocal 实例被回收后没有及时清理对应的值，那么这些值会一直占用内存，无法释放。</li>
</ul>
<h3 id="如何防止内存泄漏？">如何防止内存泄漏？</h3>
<ol>
<li>显式调用 remove() 方法</li>
<li>垃圾回收时自动清理</li>
</ol>
<h2 id="classloader-方法重写了会怎么样">classloader 方法重写了会怎么样</h2>
<p>在 Java 中，ClassLoader 是负责加载类的核心组件。它定义了几个关键方法，用于实现类的加载逻辑。如果重写这些方法，可能会影响类加载的行为。</p>
<ol>
<li>findClass(String name): 该方法用于加载指定类。如果重写该方法，则会导致自定义类的加载方式。从文件系统、网络或其他非标准位置加载类。</li>
<li>loadClass(String name):默认双亲委派机制，重写此方法并跳过父类加载器，可能会破坏双亲委派机制，导致核心类库被重复加载或出现类冲突。</li>
<li>defineClass(String name, byte[] b, int off, int len)：默认行为：将字节数组转换为 Class 对象，是类加载的核心步骤。通常不建议重写此方法，因为它是 JVM 内部实现的一部分。</li>
<li>findResource(String name) 和 findResources(String name)：默认用于查找类路径中的资源文件，可以通过重写这些方法来自定义资源加载逻辑，例如从网络或数据库中加载资源。</li>
</ol>
<h2 id="springboot-用到了哪些设计模式？">springboot 用到了哪些设计模式？</h2>
<ul>
<li>工厂设计模式 : Spring 使用工厂模式通过 BeanFactory、ApplicationContext 创建 bean 对象。</li>
<li>代理设计模式 : Spring AOP 功能的实现。</li>
<li>单例设计模式 : Spring 中的 Bean 默认都是单例的。</li>
<li>模板方法模式 : Spring 中 jdbcTemplate、hibernateTemplate 等以 Template 结尾的对数据库操作的类，它们就使用到了模板模式。</li>
<li>包装器设计模式 : 我们的项目需要连接多个数据库，而且不同的客户在每次访问中根据需要会去访问不同的数据库。这种模式让我们可以根据客户的需求能够动态切换不同的数据源。</li>
<li>观察者模式: Spring 事件驱动模型就是观察者模式很经典的一个应用。</li>
<li>适配器模式 : Spring AOP 的增强或通知(Advice)使用到了适配器模式、spring MVC 中也是用到了适配器模式适配 Controller。</li>
</ul>
<h2 id="工厂方法模式一般用在哪？">工厂方法模式一般用在哪？</h2>
<ol>
<li>
<p>当一个类不知道它所必须创建的对象的类的时候</p>
</li>
<li>
<p>当一个类希望它的子类来指定它所创建的对象的时候</p>
</li>
<li>
<p>类将创建对象的职责委托给多个帮助子类中的某一个，并且你希望将哪一个帮助子类是代理者这一信息局部化的时候</p>
</li>
<li>
<p>应用：框架开发、图形用户界面(GUI)工具包、支持多样的文件格式处理</p>
</li>
</ol>
<h2 id="简单说，mysql-慢查询分析举例子，索引失效情况">简单说，mysql 慢查询分析举例子，索引失效情况</h2>
<ol>
<li>慢查询通常指的是那些执行时间超过预设阈值的 SQL 查询</li>
<li>索引失效情况分析：
<ul>
<li>隐式类型转换：如果 department_id 列定义为整数类型，而查询条件使用了字符串（例如 WHERE department_id = ‘10’），MySQL 可能需要进行隐式类型转换，这会导致索引失效。</li>
<li>函数使用：如果在索引列上使用了函数，如 WHERE YEAR(hire_date) &gt; 2010，MySQL 将无法有效利用 hire_date 上的索引，因为索引不能用于函数计算的结果。</li>
<li>范围查询后的索引使用：在这个查询中，虽然 department_id 上有索引，但是由于 hire_date 也参与了查询条件，且是一个范围查询，根据 MySQL 索引最左前缀原则，可能会导致后续的索引部分（如果有）失效或效率降低。</li>
<li>不等于和 NULL 检查：!=, NOT IN, IS NULL, IS NOT NULL 等操作符可能导致索引失效或仅部分使用索引，因为这些操作通常需要扫描整个索引树。</li>
</ul>
</li>
</ol>
<h2 id="redis-怎么保证原子操作">redis 怎么保证原子操作</h2>
<ul>
<li>单线程模型：天然保证了简单命令的原子性。</li>
<li>原子性命令：许多内置命令本身就是原子操作。</li>
<li>事务（MULTI/EXEC）：将多个命令打包成一个事务，保证按顺序执行。</li>
<li>Lua 脚本：在服务器端以原子方式执行复杂逻辑。</li>
<li>分布式锁：通过锁机制协调多个客户端对共享资源的访问。</li>
<li>乐观锁（WATCH/MULTI/EXEC）：通过监控键的变化来避免并发冲突。</li>
</ul>
<h2 id="redis-大-key-怎么处理，简单说">redis 大 key 怎么处理，简单说</h2>
<ol>
<li>设置过期时间</li>
<li>逐步删除</li>
<li>设计数据结构时考虑将大数据分散存储到多个较小的 key 中</li>
<li>使用 redis-cli --bigkeys 命令，它可以快速扫描并报告数据库中最大的 key。</li>
</ol>
<h2 id="简单说，饭店老板餐馆-20-个桌子，设计用户点餐，怎么设计系统">简单说，饭店老板餐馆 20 个桌子，设计用户点餐，怎么设计系统</h2>
<h2 id="购物车怎么实现">购物车怎么实现</h2>
<h2 id="如果-2-个人一起点，怎么让两个人相互看到对方点的，">如果 2 个人一起点，怎么让两个人相互看到对方点的，</h2>
<h2 id="redis-怎么设计数据结构">redis 怎么设计数据结构</h2>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/my/面试总结20250423/" data-toggle="tooltip" data-placement="top" title="面试总结20250423">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/my/面试总结20250421/" data-toggle="tooltip" data-placement="top" title="面试总结20250421">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

  <!-- gitalk start -->
  <!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

  <div id="gitalk-container"></div>

  
    <!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
    <script src="/js/comment/gitalk.js"></script>
  

  <script>
    var gitalk = new Gitalk({
      clientID: 'b8ec5eaa492aead3f896',
      clientSecret: '8c6a11eb25e98c705bfc57f7a9c5ed92bcb1ce09',
      repo: 'blog_comment',
      owner: 'WANGKANG1717',
      admin: 'WANGKANG1717',
      id: 'Mon Apr 21 2025 11:09:53 GMT+0800', // Ensure uniqueness and length less than 50
      distractionFreeMode: false, // Facebook-like distraction free mode
      perPage: 10,
      pagerDirection: 'last',
      createIssueManually: false,
      language: 'zh-CN',
      proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token'
    });
    gitalk.render('gitalk-container');

    var gtFolded = () => {
      setTimeout(function () {
        let markdownBody = document.getElementsByClassName("markdown-body");
        let list = Array.from(markdownBody);
        list.forEach(item => {
          if (item.clientHeight > 250) {
            item.classList.add('gt-comment-body-folded');
            item.style.maxHeight = '250px';
            item.title = 'Click to Expand';
            item.onclick = function () {
              item.classList.remove('gt-comment-body-folded');
              item.style.maxHeight = '';
              item.title = '';
              item.onclick = null;
            };
          }
        })
      }, 800);
    }
  </script>

  <!-- gitalk end -->


<!-- 2. gitment comment -->


<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#jdk8-%E5%BC%80%E5%A7%8B%EF%BC%8Chashmap-%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%EF%BC%9F"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">jdk8 开始，hashmap 底层原理？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mysql-%E6%9C%80%E4%BD%B3%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">mysql 最佳左匹配原则是什么？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#select-%E5%B9%B4%E9%BE%84%EF%BC%8C%E5%A7%93%E5%90%8D%EF%BC%8Cid-%EF%BC%8C-from-%E8%A1%A8-where-%E5%B9%B4%E9%BE%84-xx%EF%BC%8C%E8%B5%B0%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E4%BA%86%E5%90%97%EF%BC%9F"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">select(年龄，姓名，id)， from 表 where 年龄&#x3D;xx，走全表扫描了吗？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%85%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90%EF%BC%8C%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96-sql%EF%BC%9F"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">慢查询分析，怎么优化 sql？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#SELECT-%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">SELECT *怎么优化？</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E4%BC%98%E5%8C%96-SELECT-%EF%BC%9F"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">为什么需要优化 SELECT *？</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96-SELECT-%EF%BC%9F"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">如何优化 SELECT *？</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%88%86%E9%A1%B5%E6%80%8E%E4%B9%88%E5%88%86%EF%BC%8C%E4%BB%80%E4%B9%88%E8%AF%AD%E5%8F%A5%EF%BC%9F"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">分页怎么分，什么语句？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#LIMIT-%E6%B7%B1%E5%88%86%E9%A1%B5%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">LIMIT 深分页怎么处理?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mysql-%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">mysql 隔离级别哪些？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BA%8B%E5%8A%A1-acid-%E7%89%B9%E6%80%A7%EF%BC%9F"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">事务 acid 特性？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86-%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%EF%BC%9F"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">反向代理 &#x2F; 正向代理？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%EF%BC%9F"><span class="toc-nav-number">11.</span> <span class="toc-nav-text">mysql 存储引擎？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#InnoDB-%E8%A1%8C%E9%94%81%E5%AE%9E%E7%8E%B0%EF%BC%9F"><span class="toc-nav-number">12.</span> <span class="toc-nav-text">InnoDB 行锁实现？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%EF%BC%9F"><span class="toc-nav-number">13.</span> <span class="toc-nav-text">数据库主从复制原理？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#redis-%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%B9%E5%BC%8F%EF%BC%9F"><span class="toc-nav-number">14.</span> <span class="toc-nav-text">redis 的持久化方式？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B4%EF%BC%8C%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%EF%BC%8C%E5%87%BB%E7%A9%BF%EF%BC%8C%E9%9B%AA%E5%B4%A9%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3"><span class="toc-nav-number">15.</span> <span class="toc-nav-text">简单说，缓存穿透，击穿，雪崩是什么，怎么解决?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E9%99%A4%E4%BA%86-redis-%E8%BF%98%E6%9C%89%E4%BB%80%E4%B9%88%E6%96%B9%E6%B3%95"><span class="toc-nav-number">16.</span> <span class="toc-nav-text">分布式锁除了 redis 还有什么方法?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%81%87%E5%A6%82%E6%9C%89%E4%B8%80%E7%BB%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%9C%89%E5%BA%8F%E7%9A%84%EF%BC%8C%E5%A2%9E%E5%88%A0%E5%A4%9A%EF%BC%8C%E7%94%A8%E4%BB%80%E4%B9%88%E9%9B%86%E5%90%88"><span class="toc-nav-number">17.</span> <span class="toc-nav-text">假如有一组数据，有序的，增删多，用什么集合?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#jvm-%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84"><span class="toc-nav-number">18.</span> <span class="toc-nav-text">jvm 内存结构</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AE%97%E6%B3%95%E5%93%AA%E5%87%A0%E7%A7%8D"><span class="toc-nav-number">19.</span> <span class="toc-nav-text">垃圾回收算法哪几种</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#threallocal-%E5%8E%9F%E7%90%86"><span class="toc-nav-number">20.</span> <span class="toc-nav-text">threallocal 原理</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ThreadLocalMap-%E9%98%B2%E6%AD%A2%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="toc-nav-number">21.</span> <span class="toc-nav-text">ThreadLocalMap 防止内存泄漏</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9A%84%E9%A3%8E%E9%99%A9%EF%BC%9F"><span class="toc-nav-number">21.1.</span> <span class="toc-nav-text">为什么会有内存泄漏的风险？</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%EF%BC%9F"><span class="toc-nav-number">21.2.</span> <span class="toc-nav-text">如何防止内存泄漏？</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#classloader-%E6%96%B9%E6%B3%95%E9%87%8D%E5%86%99%E4%BA%86%E4%BC%9A%E6%80%8E%E4%B9%88%E6%A0%B7"><span class="toc-nav-number">22.</span> <span class="toc-nav-text">classloader 方法重写了会怎么样</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#springboot-%E7%94%A8%E5%88%B0%E4%BA%86%E5%93%AA%E4%BA%9B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%9F"><span class="toc-nav-number">23.</span> <span class="toc-nav-text">springboot 用到了哪些设计模式？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%E4%B8%80%E8%88%AC%E7%94%A8%E5%9C%A8%E5%93%AA%EF%BC%9F"><span class="toc-nav-number">24.</span> <span class="toc-nav-text">工厂方法模式一般用在哪？</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B4%EF%BC%8Cmysql-%E6%85%A2%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90%E4%B8%BE%E4%BE%8B%E5%AD%90%EF%BC%8C%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E6%83%85%E5%86%B5"><span class="toc-nav-number">25.</span> <span class="toc-nav-text">简单说，mysql 慢查询分析举例子，索引失效情况</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#redis-%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C"><span class="toc-nav-number">26.</span> <span class="toc-nav-text">redis 怎么保证原子操作</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#redis-%E5%A4%A7-key-%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%EF%BC%8C%E7%AE%80%E5%8D%95%E8%AF%B4"><span class="toc-nav-number">27.</span> <span class="toc-nav-text">redis 大 key 怎么处理，简单说</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B4%EF%BC%8C%E9%A5%AD%E5%BA%97%E8%80%81%E6%9D%BF%E9%A4%90%E9%A6%86-20-%E4%B8%AA%E6%A1%8C%E5%AD%90%EF%BC%8C%E8%AE%BE%E8%AE%A1%E7%94%A8%E6%88%B7%E7%82%B9%E9%A4%90%EF%BC%8C%E6%80%8E%E4%B9%88%E8%AE%BE%E8%AE%A1%E7%B3%BB%E7%BB%9F"><span class="toc-nav-number">28.</span> <span class="toc-nav-text">简单说，饭店老板餐馆 20 个桌子，设计用户点餐，怎么设计系统</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">29.</span> <span class="toc-nav-text">购物车怎么实现</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A6%82%E6%9E%9C-2-%E4%B8%AA%E4%BA%BA%E4%B8%80%E8%B5%B7%E7%82%B9%EF%BC%8C%E6%80%8E%E4%B9%88%E8%AE%A9%E4%B8%A4%E4%B8%AA%E4%BA%BA%E7%9B%B8%E4%BA%92%E7%9C%8B%E5%88%B0%E5%AF%B9%E6%96%B9%E7%82%B9%E7%9A%84%EF%BC%8C"><span class="toc-nav-number">30.</span> <span class="toc-nav-text">如果 2 个人一起点，怎么让两个人相互看到对方点的，</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#redis-%E6%80%8E%E4%B9%88%E8%AE%BE%E8%AE%A1%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-nav-number">31.</span> <span class="toc-nav-text">redis 怎么设计数据结构</span></a></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#面试" title="面试">面试</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://gitee.com/purify_wang" target="_blank">myGitee</a>
          </li>
          
          <li>
            <a href="https://blog.csdn.net/qq_44685940" target="_blank">myCSDN</a>
          </li>
          
          <li>
            <a href="https://blog.csdn.net/m0_50994219" target="_blank">curiostyhclzm</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
	<div class="container">
		<div class="row">
			<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
				<ul class="list-inline text-center">
					 
					<li>
						<a
							target="_blank"
							href="https://github.com/WANGKANG1717"
						>
							<span class="fa-stack fa-lg">
								<i class="fa fa-circle fa-stack-2x"></i>
								<i class="fa fa-github fa-stack-1x fa-inverse"></i>
							</span>
						</a>
					</li>
					      
				</ul>
				<p class="copyright text-muted">
					Copyright &copy; WK 2025
					<br />
					<!-- <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">浙ICP备2021029629号</a> -->
				</p>
			</div>
		</div>
	</div>
</footer>

<a id="rocket" href="#top" class=""></a>


<!-- jQuery -->
<script
	type="text/javascript"
	src="/js/jquery.min.js"
></script>
<!-- Bootstrap Core JavaScript -->
<script
	type="text/javascript"
	src="/js/bootstrap.min.js"
></script>
<!-- Custom Theme JavaScript -->
<script
	type="text/javascript"
	src="/js/hux-blog.min.js"
></script>
<!-- catalog -->
<script async="true" type="text/javascript" src="/js/catalog.js"></script>
<!-- totop(rocket) -->
<script async="true" type="text/javascript" src="/js/totop.js"></script>


<!-- Busuanzi JavaScript -->
<script
	async="async"
	src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
></script>
 
<!-- Scroll start -->
<script
	async="async"
	type="text/javascript"
	src="/js/scroll.js"
></script>
<!-- Scroll end -->
  
<!-- Mouseclick -->
<script
	type="text/javascript"
	src="/js/mouseclick.js"
	content="舍我其谁？,Laugh and grow fat...,Man proposes God disposes...,When all else is lost the future still remains...,Wasting time is robbing oneself...,Sharp tools make good work...,Cease to struggle and you cease to live...,A friend in need is a friend indeed...,Faith can move mountains...,If you gave me a chance I would take it,It&#39;s a shot in the dark but I&#39;ll make it,Know with all of your heart,you can&#39;t shake me,When I am with you,there&#39;s no place I&#39;d rather be"
	color="#9933CC,#339933,#66CCCC,#FF99CC,#CCCCFF,#6666CC,#663399,#66CC99,#FF0033,#9933CC,#339933,#66CCCC,#FF99CC,#FF0033,#66CC99"
></script>
 
<!-- ribbon -->
<script
	type="text/javascript"
	src="/js/ribbonDynamic.js"
></script>
    
<!-- viewer start -->
<!-- viewer start (Picture preview) -->

<script
	async="async"
	type="text/javascript"
	src="/js/viewer/viewer.min.js"
></script>
<script
	async="async"
	type="text/javascript"
	src="/js/viewer/pic-viewer.js"
></script>


<!-- viewer end -->


<script>
	// async load function
	function async(u, c) {
		var d = document,
			t = "script",
			o = d.createElement(t),
			s = d.getElementsByTagName(t)[0];
		o.src = u;
		if (c) {
			o.addEventListener(
				"load",
				function (e) {
					c(null, e);
				},
				false
			);
		}
		s.parentNode.insertBefore(o, s);
	}

	// fastClick.js
	async(
		"https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js",
		function () {
			var $nav = document.querySelector("nav");
			if ($nav) FastClick.attach($nav);
		}
	);
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("https://wangkang1717.github.io/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="SEARCH..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
